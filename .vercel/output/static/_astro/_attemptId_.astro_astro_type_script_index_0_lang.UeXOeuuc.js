const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/QuizResults.s64HHu1l.js","assets/jsx-runtime.D_zvdyIk.js","assets/index.GIa-TyKg.js","assets/_commonjsHelpers.D6-XlEtG.js","assets/index.CMF_dOlt.js","assets/client.alY4YNBQ.js","assets/index.Bkf-Ke-4.js","assets/QuizQuestion.CxXpQBI9.js"])))=>i.map(i=>d[i]);
import{_ as u}from"../assets/preload-helper.BlTxHScW.js";import{c as _}from"../assets/index.CS-uK3Uq.js";import{a as l}from"../assets/notifications.BUGlD4Nh.js";import"../assets/_commonjsHelpers.D6-XlEtG.js";const y="https://auyysgeurtnpidppebqj.supabase.co",E="***REMOVED***",p=_(y,E);let a=null,c=null,m=[],h=!1;async function f(){const e=window.location.pathname.split("/"),o=parseInt(e[2]),n=parseInt(e[4]);if(isNaN(o)||isNaN(n)){l("Invalid quiz or attempt ID","error");return}const{data:{session:r}}=await p.auth.getSession();if(!r){window.location.href="/login?redirect="+encodeURIComponent(window.location.pathname);return}try{await z(o,n,r.access_token),g(),document.getElementById("loading-state")?.classList.add("hidden"),document.getElementById("results-content")?.classList.remove("hidden")}catch(t){console.error("Error loading results:",t),l("Failed to load results","error")}}async function z(e,o,n){const r=await fetch(`/api/quizzes/${e}`,{headers:{Authorization:`Bearer ${n}`}});if(!r.ok)throw new Error("Failed to load quiz");const t=await r.json();a=t.quiz;const d=t.attempts?.filter(w=>w.submitted_at).length||0;h=a.max_attempts===0||d<a.max_attempts;const s=await fetch(`/api/quizzes/${e}/attempts/${o}`,{headers:{Authorization:`Bearer ${n}`}});if(!s.ok)throw new Error("Failed to load attempt");const i=await s.json();c=i.attempt,m=i.questions||[],document.getElementById("quiz-title").textContent=`${a.title} - Results`,document.getElementById("breadcrumb").textContent=`Attempt #${c.attempt_number}`,document.getElementById("back-btn")?.addEventListener("click",()=>{window.location.href=`/quizzes/${e}/attempts`})}function g(){if(!a||!c)return;const e=document.getElementById("results-summary");u(async()=>{const{QuizResults:o}=await import("../assets/QuizResults.s64HHu1l.js");return{QuizResults:o}},__vite__mapDeps([0,1,2,3,4])).then(({QuizResults:o})=>{u(async()=>{const{createRoot:n}=await import("../assets/client.alY4YNBQ.js").then(r=>r.c);return{createRoot:n}},__vite__mapDeps([5,4,6])).then(({createRoot:n})=>{n(e).render(o({quiz:a,attempt:c,canRetake:h,onRetry:R,onReview:v}))})})}function v(){const e=document.getElementById("review-container");e.classList.remove("hidden");const o=document.getElementById("questions-review");u(async()=>{const{QuizQuestion:n}=await import("../assets/QuizQuestion.CxXpQBI9.js");return{QuizQuestion:n}},__vite__mapDeps([7,1,2,3,4])).then(({QuizQuestion:n})=>{u(async()=>{const{createRoot:r}=await import("../assets/client.alY4YNBQ.js").then(t=>t.c);return{createRoot:r}},__vite__mapDeps([5,4,6])).then(({createRoot:r})=>{m.forEach((t,d)=>{const s=document.createElement("div");o.appendChild(s);const i=c.answers_json.find(I=>I.question_id===t.id);r(s).render(n({question:{id:t.id,type:t.type,questionText:t.question_text,questionImageUrl:t.question_image_url,options:t.options_json,points:t.points,orderIndex:d},questionNumber:d+1,totalQuestions:m.length,value:i?.answer||"",onChange:()=>{},readonly:!0,showCorrectAnswer:a.show_correct_answers,correctAnswer:t.correct_answer||t.correct_answers_json,isCorrect:i?.is_correct,explanation:t.explanation}))})})}),e.scrollIntoView({behavior:"smooth"})}async function R(){if(a)try{const{data:{session:e}}=await p.auth.getSession();if(!e)return;const o=await fetch(`/api/quizzes/${a.id}/start`,{method:"POST",headers:{Authorization:`Bearer ${e.access_token}`,"Content-Type":"application/json"}});if(!o.ok){const r=await o.json();l(r.error||"Failed to start quiz","error");return}const n=await o.json();window.location.href=`/quizzes/${a.id}/take?attemptId=${n.attempt.id}`}catch(e){console.error("Error starting retry:",e),l("Failed to start quiz","error")}}document.getElementById("hide-review-btn")?.addEventListener("click",()=>{document.getElementById("review-container")?.classList.add("hidden")});document.getElementById("logout-btn")?.addEventListener("click",async()=>{await p.auth.signOut(),window.location.href="/login"});f();
