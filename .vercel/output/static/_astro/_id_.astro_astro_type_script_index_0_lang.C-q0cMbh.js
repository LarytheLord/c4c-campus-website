import{c as I}from"../assets/index.CS-uK3Uq.js";import"../assets/_commonjsHelpers.D6-XlEtG.js";const w="https://auyysgeurtnpidppebqj.supabase.co",B="***REMOVED***",c=I(w,B);let o=null,m=[];const x=window.location.pathname.split("/"),h=parseInt(x[x.length-1]);function l(e,t,n="info",s){const a=document.getElementById("notification-modal"),r=document.getElementById("notification-icon"),d=document.getElementById("notification-title"),i=document.getElementById("notification-message"),u=document.getElementById("notification-actions"),E={success:"âœ…",error:"âŒ",info:"â„¹ï¸",warning:"âš ï¸"};r&&(r.textContent=E[n]),d&&(d.textContent=e),i&&(i.textContent=t),u&&(s&&s.length>0?(u.innerHTML=s.map(g=>`<button class="${g.primary?"btn btn-primary":"btn btn-ghost"} flex-1 modal-action-btn">${g.label}</button>`).join(""),u.querySelectorAll(".modal-action-btn").forEach((g,v)=>{g.addEventListener("click",()=>{a?.classList.add("hidden"),s[v].onClick()})})):(u.innerHTML='<button class="btn btn-primary flex-1 modal-close-btn">OK</button>',u.querySelector(".modal-close-btn")?.addEventListener("click",()=>{a?.classList.add("hidden")}))),a?.classList.remove("hidden")}function L(e,t,n,s){l(e,t,"warning",[{label:"Cancel",onClick:(()=>{}),primary:!1},{label:"Confirm",onClick:n,primary:!0}])}async function C(){const{data:{user:e}}=await c.auth.getUser();if(!e){window.location.href="/login";return}if(await S(),!o){document.getElementById("loading-state")?.classList.add("hidden"),document.getElementById("error-state")?.classList.remove("hidden");return}document.getElementById("loading-state")?.classList.add("hidden"),document.getElementById("main-content")?.classList.remove("hidden"),await p(),A()}async function S(){const{data:e,error:t}=await c.from("cohorts").select("*, courses(name, slug, id)").eq("id",h).single();if(t||!e){console.error("Error loading cohort:",t);return}o=e,document.getElementById("cohort-name-header").textContent=o.name,document.getElementById("course-name-header").textContent=o.courses?.name||"Unknown Course",document.getElementById("cohort-name").textContent=o.name,document.getElementById("course-name").textContent=o.courses?.name||"Unknown Course",document.getElementById("breadcrumb-cohort").textContent=o.name;const n=document.getElementById("cohort-status-badge");if(n&&(n.textContent=o.status.charAt(0).toUpperCase()+o.status.slice(1),n.className=`px-3 py-1 rounded-full text-sm font-medium ${M(o.status)}`),document.getElementById("cohort-start-date").textContent=f(o.start_date),document.getElementById("cohort-end-date").textContent=o.end_date?f(o.end_date):"No end date",document.getElementById("cohort-max-students").textContent=o.max_students.toString(),o.end_date){const s=new Date(o.end_date),a=new Date,r=Math.ceil((s.getTime()-a.getTime())/(1e3*60*60*24));document.getElementById("stat-days-remaining").textContent=r>0?r.toString():"Ended"}else document.getElementById("stat-days-remaining").textContent="Ongoing"}async function p(){const e=document.getElementById("students-loading"),t=document.getElementById("students-list"),n=document.getElementById("students-empty");e?.classList.remove("hidden"),t?.classList.add("hidden"),n?.classList.add("hidden");const{data:s,error:a}=await c.from("enrollments").select(`
          *,
          applications!inner(name, email, user_id)
        `).eq("cohort_id",h).order("enrolled_at",{ascending:!1});if(e?.classList.add("hidden"),a){console.error("Error loading students:",a),n?.classList.remove("hidden");return}m=s||[],document.getElementById("stat-total-students").textContent=m.length.toString();const r=m.filter(d=>d.status==="active").length;if(document.getElementById("stat-active-students").textContent=r.toString(),document.getElementById("stat-avg-progress").textContent="0%",m.length===0){n?.classList.remove("hidden");return}t.innerHTML=m.map(d=>{const i=d.applications;return`
          <div class="border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow">
            <div class="flex items-center justify-between gap-4">
              <div class="flex items-center gap-3 flex-1">
                <div class="w-10 h-10 bg-primary/10 rounded-full flex items-center justify-center">
                  <span class="text-xl">ðŸ‘¤</span>
                </div>
                <div class="flex-1 min-w-0">
                  <h4 class="font-semibold truncate">${i.name}</h4>
                  <p class="text-sm text-text-muted truncate">${i.email}</p>
                  <div class="flex items-center gap-2 mt-1">
                    <span class="text-xs px-2 py-1 rounded ${b(d.status).color}">
                      ${b(d.status).text}
                    </span>
                    <span class="text-xs text-text-muted">
                      Enrolled ${f(d.enrolled_at)}
                    </span>
                  </div>
                </div>
              </div>
              <div class="flex gap-2">
                <a href="/teacher/students/${i.user_id}" class="btn btn-sm btn-ghost">View</a>
                <button class="btn btn-sm btn-error remove-student" data-id="${d.id}" data-name="${i.name}">Remove</button>
              </div>
            </div>
          </div>
        `}).join(""),t?.classList.remove("hidden"),t?.querySelectorAll(".remove-student").forEach(d=>{d.addEventListener("click",async()=>{const i=d.getAttribute("data-id"),u=d.getAttribute("data-name");L("Remove Student",`Are you sure you want to remove ${u} from this cohort?`,async()=>{await _(parseInt(i))})})})}async function _(e){const{error:t}=await c.from("enrollments").delete().eq("id",e);if(t){l("Error","Failed to remove student: "+t.message,"error");return}l("Success","Student removed successfully!","success"),await p()}function A(){document.querySelectorAll(".tab-button").forEach(e=>{e.addEventListener("click",()=>{const t=e.getAttribute("data-tab");t&&D(t)})}),document.getElementById("edit-cohort-btn")?.addEventListener("click",()=>{l("Edit Cohort","Cohort editing functionality will be available soon. For now, please use the Admin Dashboard to edit cohort details.","info")}),document.getElementById("add-student-btn")?.addEventListener("click",$),document.getElementById("close-add-student-modal")?.addEventListener("click",y),document.getElementById("cancel-add-student")?.addEventListener("click",y),document.getElementById("add-student-form")?.addEventListener("submit",q),document.getElementById("logout-btn")?.addEventListener("click",async()=>{await c.auth.signOut(),window.location.href="/login"})}function D(e){document.querySelectorAll(".tab-button").forEach(t=>{t.getAttribute("data-tab")===e?(t.classList.add("active","border-primary","text-primary"),t.classList.remove("border-transparent","text-text-muted")):(t.classList.remove("active","border-primary","text-primary"),t.classList.add("border-transparent","text-text-muted"))}),document.querySelectorAll(".tab-content").forEach(t=>{t.classList.add("hidden")}),document.getElementById(`content-${e}`)?.classList.remove("hidden"),e==="schedule"&&k()}async function k(){const e=document.getElementById("modules-schedule");if(!e)return;e.innerHTML='<p class="text-center text-text-muted py-8">Loading schedule...</p>';const{data:t,error:n}=await c.from("modules").select("*").eq("course_id",o.courses.id).order("order_index",{ascending:!0});if(n||!t||t.length===0){e.innerHTML='<p class="text-center text-text-muted py-8">No modules found for this course.</p>';return}e.innerHTML=t.map(s=>`
        <div class="border border-gray-200 rounded-lg p-4">
          <div class="flex items-center justify-between">
            <div class="flex items-center gap-3">
              <span class="text-2xl">ðŸ“š</span>
              <div>
                <h4 class="font-semibold">${s.title}</h4>
                <p class="text-sm text-text-muted">Module ${s.order_index}</p>
              </div>
            </div>
            <span class="text-sm text-text-muted">Available immediately</span>
          </div>
        </div>
      `).join("")}function $(){document.getElementById("add-student-modal")?.classList.remove("hidden"),document.getElementById("student-email").value=""}function y(){document.getElementById("add-student-modal")?.classList.add("hidden")}async function q(e){e.preventDefault();const t=document.getElementById("student-email").value,{data:n,error:s}=await c.from("applications").select("user_id, name").eq("email",t).single();if(s||!n){l("Error","No user found with this email address.","error");return}const{data:a}=await c.from("enrollments").select("id").eq("cohort_id",h).eq("user_id",n.user_id).single();if(a){l("Error","This student is already enrolled in this cohort.","error");return}const{error:r}=await c.from("enrollments").insert([{cohort_id:h,user_id:n.user_id,status:"active",enrolled_at:new Date().toISOString()}]);if(r){l("Error","Failed to add student: "+r.message,"error");return}y(),l("Success",`${n.name} has been added to the cohort!`,"success"),await p()}function f(e){return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}function M(e){return{upcoming:"bg-blue-500/10 text-blue-500",active:"bg-green-500/10 text-green-500",completed:"bg-gray-500/10 text-gray-500",archived:"bg-orange-500/10 text-orange-500"}[e]||"bg-gray-500/10 text-gray-500"}function b(e){return{active:{text:"Active",color:"bg-green-500/10 text-green-600"},completed:{text:"Completed",color:"bg-blue-500/10 text-blue-600"},dropped:{text:"Dropped",color:"bg-red-500/10 text-red-600"},paused:{text:"Paused",color:"bg-orange-500/10 text-orange-600"}}[e]||{text:e,color:"bg-gray-500/10 text-gray-600"}}C();
