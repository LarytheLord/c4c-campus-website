import{s as n}from"../assets/supabase.DdTcER9f.js";import"../assets/index.CS-uK3Uq.js";import"../assets/_commonjsHelpers.D6-XlEtG.js";const u=document.getElementById("loading-state"),m=document.getElementById("error-state"),d=document.getElementById("reset-password-form"),h=document.getElementById("success-state");async function w(){try{const{data:{session:s},error:r}=await n.auth.getSession();if(r||!s){const a=new URLSearchParams(window.location.hash.substring(1)),e=a.get("access_token"),t=a.get("type");if(e&&t==="recovery"){const{error:i}=await n.auth.setSession({access_token:e,refresh_token:a.get("refresh_token")||""});if(i){c();return}l()}else c()}else l()}catch(s){console.error("Token verification error:",s),c()}}function c(){u?.classList.add("hidden"),m?.classList.remove("hidden")}function l(){u?.classList.add("hidden"),d?.classList.remove("hidden")}function f(){d?.classList.add("hidden"),h?.classList.remove("hidden")}w();d?.addEventListener("submit",async s=>{s.preventDefault();const r=document.getElementById("password").value,a=document.getElementById("confirmPassword").value,e=document.getElementById("form-error-message"),t=d.querySelector('button[type="submit"]');if(!e||!t)return;if(r!==a){e.textContent="Passwords do not match. Please try again.",e.classList.remove("hidden");return}if(!/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[!@#$%^&*()_+\-=\[\]{}|;:,.<>?]).{12,}$/.test(r)){e.textContent="Password does not meet the requirements. Please ensure it has at least 12 characters with uppercase, lowercase, number, and special character.",e.classList.remove("hidden");return}t.disabled=!0,t.textContent="Updating...",e.classList.add("hidden");try{const{error:o}=await n.auth.updateUser({password:r});o?(e.textContent=o.message||"Unable to update password. Please try again.",e.classList.remove("hidden"),t.disabled=!1,t.textContent="Update Password"):(await n.auth.signOut(),f())}catch(o){console.error("Password update error:",o),e.textContent="An error occurred. Please try again later.",e.classList.remove("hidden"),t.disabled=!1,t.textContent="Update Password"}});
