import{s as l}from"../assets/supabase.DdTcER9f.js";import"../assets/index.CS-uK3Uq.js";import"../assets/_commonjsHelpers.D6-XlEtG.js";let u=null;async function B(){const{data:{session:e}}=await l.auth.getSession();if(!e)return window.location.href="/login",!1;const{data:o}=await l.from("applications").select("role").eq("user_id",e.user.id).single();return!o||o.role!=="admin"?(window.location.href="/admin/dashboard",!1):!0}async function _(){try{const{data:{session:e}}=await l.auth.getSession(),o=e?.access_token,t=await fetch("/api/admin/config/branding",{headers:{Authorization:`Bearer ${o}`}});if(!t.ok)throw new Error("Failed to load branding");u=await t.json(),v(u),d()}catch(e){console.error("Error loading branding:",e),E("Failed to load branding settings")}}function v(e){document.getElementById("brand_name").value=e.brand_name||"",document.getElementById("tagline").value=e.tagline||"",["primary_color","secondary_color","background_color","surface_color","text_color","border_color"].forEach(t=>{const n=e[t]||"#000000";document.getElementById(t).value=n,document.getElementById(`${t}_hex`).value=n}),document.getElementById("font_family_heading").value=e.font_family_heading||"",document.getElementById("font_family_body").value=e.font_family_body||"",document.getElementById("font_family_mono").value=e.font_family_mono||"",document.getElementById("border_radius").value=e.border_radius||"",document.getElementById("button_style").value=e.button_style||"rounded"}function d(){const e=document.getElementById("live-preview");if(!e)return;const o=document.getElementById("brand_name").value,t=document.getElementById("tagline").value,n=document.getElementById("primary_color").value,r=document.getElementById("secondary_color").value,a=document.getElementById("surface_color").value,m=document.getElementById("text_color").value,y=document.getElementById("border_color").value,g=e.querySelector(".preview-brand-name");g&&(g.textContent=o);const f=e.querySelector(".preview-tagline");f&&(f.textContent=t),e.style.backgroundColor=a,e.style.color=m,e.style.borderColor=y;const c=e.querySelector(".preview-btn-primary");c&&(c.style.backgroundColor=n,c.style.color="#ffffff");const s=e.querySelector(".preview-btn-secondary");s&&(s.style.backgroundColor=r,s.style.color="#ffffff");const i=e.querySelector(".preview-card");i&&(i.style.backgroundColor=a,i.style.borderColor=y)}async function b(){const e=document.getElementById("save-btn"),o=document.getElementById("save-btn-text"),t=document.getElementById("save-btn-loading");try{e.disabled=!0,o?.classList.add("hidden"),t?.classList.remove("hidden");const n={brand_name:document.getElementById("brand_name").value,tagline:document.getElementById("tagline").value,primary_color:document.getElementById("primary_color").value,secondary_color:document.getElementById("secondary_color").value,background_color:document.getElementById("background_color").value,surface_color:document.getElementById("surface_color").value,text_color:document.getElementById("text_color").value,border_color:document.getElementById("border_color").value,font_family_heading:document.getElementById("font_family_heading").value,font_family_body:document.getElementById("font_family_body").value,font_family_mono:document.getElementById("font_family_mono").value,border_radius:document.getElementById("border_radius").value,button_style:document.getElementById("button_style").value},{data:{session:r}}=await l.auth.getSession(),a=r?.access_token;if(!(await fetch("/api/admin/config/branding",{method:"PUT",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify(n)})).ok)throw new Error("Failed to save branding");h(),await _()}catch(n){console.error("Error saving branding:",n),E("Failed to save changes")}finally{e.disabled=!1,o?.classList.remove("hidden"),t?.classList.add("hidden")}}function h(){const e=document.getElementById("success-toast");e?.classList.remove("hidden"),setTimeout(()=>e?.classList.add("hidden"),3e3)}function E(e){const o=document.getElementById("error-toast"),t=document.getElementById("error-message");t&&(t.textContent=e),o?.classList.remove("hidden"),setTimeout(()=>o?.classList.add("hidden"),3e3)}async function I(){if(!await B())return;document.getElementById("loading-state")?.classList.add("hidden"),document.getElementById("settings-content")?.classList.remove("hidden"),await _(),["primary_color","secondary_color","background_color","surface_color","text_color","border_color"].forEach(t=>{const n=document.getElementById(t),r=document.getElementById(`${t}_hex`);n?.addEventListener("input",a=>{r.value=a.target.value,d()}),r?.addEventListener("input",a=>{n.value=a.target.value,d()})}),document.querySelectorAll("input, select").forEach(t=>{t.addEventListener("input",d)}),document.getElementById("save-btn")?.addEventListener("click",b),document.getElementById("reset-btn")?.addEventListener("click",()=>{confirm("Reset all branding settings to defaults?")&&(v(u),d())}),document.getElementById("logout-btn")?.addEventListener("click",async()=>{await l.auth.signOut(),window.location.href="/login"})}I();
